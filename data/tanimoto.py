"""compute mean and std from tanimoto.pkl generated by ../class_tanimoto.py"""
import pickle
import numpy as np
import matplotlib.pyplot as plt

if __name__ == "__main__":
    np.set_printoptions(precision=4)
    with open('./tanimoto.pkl', 'rb') as f:
        tanimoto = pickle.load(f)

    for k, scores in enumerate(tanimoto):
        print(f'computing class {k}...')
        scores = np.array(scores)
        print(scores.shape)
        mean = np.mean(scores)
        std = np.std(scores)
        print(f'mean: {mean}, std: {std}')

        # plot
        fig, ax = plt.subplots()

        n, bins, patches = ax.hist(scores, 20, density=False)
        ax.set_xlabel('Tanimoto similarity')
        ax.set_ylabel('Number of pairs')
        ax.set_title(f'class_{k}, mean: {mean:.2f}, std: {std:.2f}')
        fig.tight_layout()
        plt.savefig(f'class_{k}.png')
